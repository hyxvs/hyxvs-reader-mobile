import{_ as x,u as C,c as P,a as m,b as a,w as r,r as i,d as t,e as S,o as T,f as b}from"./index-BC7CpVgk.js";import{l as B,r as L}from"./auth-Bq9qZfB1.js";import{s as _}from"./request-BWFo0bpa.js";const F={class:"login-page"},R={class:"login-header"},z={class:"login-btn"},E={class:"login-btn"},I={__name:"Login",setup(j){const w=S(),v=C(),p=i("login"),u=i(!1),d=i({username:"",password:""}),o=i({username:"",password:"",confirmPassword:"",realName:"",idCard:"",email:""}),y=s=>s!==o.value.password?"两次输入的密码不一致":!0,U=async()=>{u.value=!0;try{const s=await B(d.value);v.setToken(s.data.token),v.setUser(s.data.user),_({type:"success",message:"登录成功"}),w.push("/home")}catch(s){console.error("登录失败:",s)}finally{u.value=!1}},k=async()=>{u.value=!0;try{const{confirmPassword:s,...e}=o.value;await L(e),_({type:"success",message:"注册成功，请登录"}),p.value="login"}catch(s){console.error("注册失败:",s)}finally{u.value=!1}};return(s,e)=>{const q=t("van-icon"),n=t("van-field"),f=t("van-cell-group"),g=t("van-button"),c=t("van-form"),V=t("van-tab"),N=t("van-tabs");return T(),P("div",F,[m("div",R,[a(q,{name:"books-o",size:"60",color:"#1989fa"}),e[9]||(e[9]=m("h1",null,"图书馆读者系统",-1)),e[10]||(e[10]=m("p",null,"欢迎登录",-1))]),a(N,{modelValue:p.value,"onUpdate:modelValue":e[8]||(e[8]=l=>p.value=l),background:"transparent","line-width":"40px"},{default:r(()=>[a(V,{title:"登录",name:"login"},{default:r(()=>[a(c,{onSubmit:U},{default:r(()=>[a(f,{inset:""},{default:r(()=>[a(n,{modelValue:d.value.username,"onUpdate:modelValue":e[0]||(e[0]=l=>d.value.username=l),name:"username",label:"用户名",placeholder:"请输入用户名",rules:[{required:!0,message:"请输入用户名"}],"left-icon":"user-o"},null,8,["modelValue"]),a(n,{modelValue:d.value.password,"onUpdate:modelValue":e[1]||(e[1]=l=>d.value.password=l),type:"password",name:"password",label:"密码",placeholder:"请输入密码",rules:[{required:!0,message:"请输入密码"}],"left-icon":"lock"},null,8,["modelValue"])]),_:1}),m("div",z,[a(g,{round:"",block:"",type:"primary","native-type":"submit",loading:u.value},{default:r(()=>[...e[11]||(e[11]=[b(" 登录 ",-1)])]),_:1},8,["loading"])])]),_:1})]),_:1}),a(V,{title:"注册",name:"register"},{default:r(()=>[a(c,{onSubmit:k},{default:r(()=>[a(f,{inset:""},{default:r(()=>[a(n,{modelValue:o.value.username,"onUpdate:modelValue":e[2]||(e[2]=l=>o.value.username=l),name:"username",label:"用户名",placeholder:"请输入用户名",rules:[{required:!0,message:"请输入用户名"}]},null,8,["modelValue"]),a(n,{modelValue:o.value.password,"onUpdate:modelValue":e[3]||(e[3]=l=>o.value.password=l),type:"password",name:"password",label:"密码",placeholder:"请输入密码",rules:[{required:!0,message:"请输入密码"}]},null,8,["modelValue"]),a(n,{modelValue:o.value.confirmPassword,"onUpdate:modelValue":e[4]||(e[4]=l=>o.value.confirmPassword=l),type:"password",name:"confirmPassword",label:"确认密码",placeholder:"请再次输入密码",rules:[{required:!0,message:"请再次输入密码"},{validator:y}]},null,8,["modelValue","rules"]),a(n,{modelValue:o.value.realName,"onUpdate:modelValue":e[5]||(e[5]=l=>o.value.realName=l),name:"realName",label:"真实姓名",placeholder:"请输入真实姓名",rules:[{required:!0,message:"请输入真实姓名"}]},null,8,["modelValue"]),a(n,{modelValue:o.value.idCard,"onUpdate:modelValue":e[6]||(e[6]=l=>o.value.idCard=l),name:"idCard",label:"身份证号",placeholder:"请输入身份证号",rules:[{required:!0,message:"请输入身份证号"}]},null,8,["modelValue"]),a(n,{modelValue:o.value.email,"onUpdate:modelValue":e[7]||(e[7]=l=>o.value.email=l),name:"email",label:"邮箱",type:"email",placeholder:"请输入邮箱",rules:[{required:!0,message:"请输入邮箱"}]},null,8,["modelValue"])]),_:1}),m("div",E,[a(g,{round:"",block:"",type:"primary","native-type":"submit",loading:u.value},{default:r(()=>[...e[12]||(e[12]=[b(" 注册 ",-1)])]),_:1},8,["loading"])])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}},H=x(I,[["__scopeId","data-v-79618ac3"]]);export{H as default};
